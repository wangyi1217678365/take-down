# 浏览器网址解析全过程

## 解析当前URL
> 首先会对 URL 进行解析，分析所需要使用的传输协议和请求的资源的路径。如果输入的 URL 中的协议或者主机名不合法，将会把地址栏中输入的内容传递给搜索引擎。如果没有问题，浏览器会检查 URL 中是否出现了非法字符，如果存在非法字符，则对非法字符进行转义后再进行下一过程。

## 缓存判断
> 浏览器会判断所请求的资源是否在缓存里，如果请求的资源在缓存里并且没有失效，那么就直接使用，否则向服务器发起新的请求。

## DNS解析（找到URL中域名所对应的IP地址）
> 首先会判断浏览器缓存。如果有泽直接使用缓存，如果没有则向本地 DNS 服务器发起请求。
  - 如果是一个CDN专用的DNS服务器：
    1. DNS系统就会将域名解析权交给CNAME（指向的CDN专用的DNS服务器）。 
    2. CNAME将CDN的全局负载均衡设备IP地址返回给用户。
    3. 用户向CDN的全局负载均衡设备发起数据请求。
    4. CDN的全局负载均衡设备根据用户的IP地址，以及用户请求的内容URL，选择一台用户所属区域内的区域负载均衡设备。
    5. 区域负载均衡设备选择一台合适的缓存服务器来提供服务，将该缓存服务器的IP地址返回给全局负载均衡设备。
    6. 全局负载均衡设备把服务器的IP地址返回给用户。
    7. 用户向该缓存服务器发起请求，缓存服务器响应用户的请求，将用户所需内容发送至用户终端。
  - 如果不是：
    1. 判断本地是否有该域名的 IP 地址缓存（操作系统缓存，本地host文件），如果有则使用完成解析，如果没有则向本地dns服务器发起请求。
    2. 如果缓存服务器无法找到对应IP，则会把信息传递给递归服务器。
    3. 获得负责的顶级域名服务器的地址后，再向顶级域名服务器请求，然后获得负责的权威域名服务器的地址后，再向权威域名服务器发起请求
